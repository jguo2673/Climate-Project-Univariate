inno_ma2 <- innovation_algorithm(gamma_ma2, x = ma2, m = n)
theta50 <- inno_ma2$theta[n, 1:n]
nu <- inno_ma2$nu
nu_rev <- rev(nu)
pred_ma2_inno <- sum(theta50 * nu_rev)
theta1 <- 0.5; theta2 <- 0.5
pred_ma2_theoretical <- theta1 * innov_ma2[50] + theta2 * innov_ma2[49]
pred_ar2_DL
pred_ar2_theoretical
pred_ar2_DL - pred_ar2_theoretical
pred_ma2_inno
pred_ma2_theoretical
pred_ma2_inno - pred_ma2_theoretical
theta50[1:10]
durbin_levinson <- function(gamma, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
phi <- matrix(NA, nrow = m, ncol = m)
refl <- numeric(m)
sigma2 <- numeric(m+1)
sigma2[1] <- gamma[1]
refl[1] <- gamma[2] / gamma[1]
phi[1,1] <- refl[1]
sigma2[2] <- sigma2[1] * (1 - refl[1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(phi[k-1,1:(k-1)] * rev(gamma[2:k]))
den <- sigma2[k]
refl[k] <- num / den
phi[k,1:k] <- c(phi[k-1,1:(k-1)] - refl[k] * rev(phi[k-1,1:(k-1)]), refl[k])
sigma2[k+1] <- sigma2[k] * (1 - refl[k]^2)
}
}
list(phi = phi, refl = refl, sigma2 = sigma2)
}
innovation_algorithm <- function(gamma, x = NULL, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
theta <- matrix(0, nrow = m, ncol = m)
v <- numeric(m+1)
v[1] <- gamma[1]
theta[1,1] <- gamma[2] / v[1]
v[2] <- v[1] * (1 - theta[1,1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(theta[k-1,1:(k-1)] * rev(gamma[2:k]))
theta[k,k] <- num / v[k]
for (j in 1:(k-1)) {
theta[k,j] <- theta[k-1,j] - theta[k,k] * theta[k-1,k-j+1]
}
v[k+1] <- v[k] * (1 - theta[k,k]^2)
}
}
out <- list(theta = theta, v = v)
if (!is.null(x)) {
n <- length(x)
nu <- numeric(n)
nu[1] <- x[1]
if (n >= 2) {
for (t in 2:n) {
k <- t-1
if (k <= m) {
preds <- theta[k,1:k]
} else {
preds <- theta[m,1:m]
}
nu[t] <- x[t] - sum(preds * rev(nu[(t-k):(t-1)]))
}
}
out$nu <- nu
}
out
}
sample_acov <- function(x, m = length(x)-1) {
x <- as.numeric(x)
n <- length(x)
xbar <- mean(x)
gamma <- numeric(m+1)
for (h in 0:m) {
gamma[h+1] <- sum((x[1:(n-h)] - xbar) * (x[(1+h):n] - xbar)) / n
}
gamma
}
set.seed(12345)
n <- 50
ar2 <- as.numeric(arima.sim(model = list(ar = c(0.5, -0.5)), n = n))
innov_ma2 <- rnorm(n)
ma2 <- as.numeric(arima.sim(model = list(ma = c(0.5, 0.5)), n = n, innov = innov_ma2))
gamma_ar2 <- sample_acov(ar2, m = n-1)
gamma_ma2 <- sample_acov(ma2, m = n-1)
dl_ar2 <- durbin_levinson(gamma_ar2, m = n-1)
phi49 <- dl_ar2$phi[n-1, 1:(n-1)]
phi50 <- c(phi49, 0)
pred_ar2_DL <- sum(phi50 * rev(ar2))
phi1 <- 0.5
phi2 <- -0.5
pred_ar2_theoretical <- phi1 * ar2[50] + phi2 * ar2[49]
inno_ma2 <- innovation_algorithm(gamma_ma2, x = ma2, m = n-1)
theta49 <- inno_ma2$theta[n-1, 1:(n-1)]
theta50 <- c(theta49, 0)
nu <- inno_ma2$nu
pred_ma2_inno <- sum(theta50 * rev(nu))
theta1 <- 0.5
theta2 <- 0.5
pred_ma2_theoretical <- theta1 * innov_ma2[50] + theta2 * innov_ma2[49]
durbin_levinson <- function(gamma, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
phi <- matrix(NA, nrow = m, ncol = m)
refl <- numeric(m)
sigma2 <- numeric(m+1)
sigma2[1] <- gamma[1]
refl[1] <- gamma[2] / gamma[1]
phi[1,1] <- refl[1]
sigma2[2] <- sigma2[1] * (1 - refl[1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(phi[k-1,1:(k-1)] * rev(gamma[2:k]))
den <- sigma2[k]
refl[k] <- num / den
phi[k,1:k] <- c(phi[k-1,1:(k-1)] - refl[k] * rev(phi[k-1,1:(k-1)]), refl[k])
sigma2[k+1] <- sigma2[k] * (1 - refl[k]^2)
}
}
list(phi = phi, refl = refl, sigma2 = sigma2)
}
innovation_algorithm <- function(gamma, x = NULL, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
theta <- matrix(0, nrow = m, ncol = m)
v <- numeric(m+1)
v[1] <- gamma[1]
theta[1,1] <- gamma[2] / v[1]
v[2] <- v[1] * (1 - theta[1,1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(theta[k-1,1:(k-1)] * rev(gamma[2:k]))
theta[k,k] <- num / v[k]
for (j in 1:(k-1)) {
theta[k,j] <- theta[k-1,j] - theta[k,k] * theta[k-1,k-j+1]
}
v[k+1] <- v[k] * (1 - theta[k,k]^2)
}
}
out <- list(theta = theta, v = v)
if (!is.null(x)) {
n <- length(x)
nu <- numeric(n)
nu[1] <- x[1]
if (n >= 2) {
for (t in 2:n) {
k <- t-1
if (k <= m) {
preds <- theta[k,1:k]
} else {
preds <- theta[m,1:m]
}
nu[t] <- x[t] - sum(preds * rev(nu[(t-k):(t-1)]))
}
}
out$nu <- nu
}
out
}
sample_acov <- function(x, m = length(x)-1) {
x <- as.numeric(x)
n <- length(x)
xbar <- mean(x)
gamma <- numeric(m+1)
for (h in 0:m) {
gamma[h+1] <- sum((x[1:(n-h)] - xbar) * (x[(1+h):n] - xbar)) / n
}
gamma
}
set.seed(12345)
n <- 50
ar2 <- as.numeric(arima.sim(model = list(ar = c(0.5, -0.5)), n = n))
innov_ma2 <- rnorm(n)
ma2 <- as.numeric(arima.sim(model = list(ma = c(0.5, 0.5)), n = n, innov = innov_ma2))
gamma_ar2 <- sample_acov(ar2, m = 49)
dl_ar2 <- durbin_levinson(gamma_ar2, m = 49)
phi50 <- dl_ar2$phi[49, 1:49]
DL_pred_ar2 <- sum(phi50 * rev(ar2))
phi1 <- 0.5
phi2 <- -0.5
theoretical_ar2 <- phi1 * ar2[50] + phi2 * ar2[49]
gamma_ma2 <- sample_acov(ma2, m = 49)
inno_ma2 <- innovation_algorithm(gamma_ma2, x = ma2, m = 49)
theta50 <- inno_ma2$theta[49, 1:49]
nu <- inno_ma2$nu
inno_pred_ma2 <- sum(theta50 * rev(nu))
theta1 <- 0.5
theta2 <- 0.5
theoretical_ma2 <- theta1 * innov_ma2[50] + theta2 * innov_ma2[49]
durbin_levinson <- function(gamma, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
phi <- matrix(NA, nrow = m, ncol = m)
refl <- numeric(m)
sigma2 <- numeric(m+1)
sigma2[1] <- gamma[1]
refl[1] <- gamma[2] / gamma[1]
phi[1,1] <- refl[1]
sigma2[2] <- sigma2[1] * (1 - refl[1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(phi[k-1,1:(k-1)] * rev(gamma[2:k]))
refl[k] <- num / sigma2[k]
phi[k,1:k] <- c(phi[k-1,1:(k-1)] - refl[k] * rev(phi[k-1,1:(k-1)]), refl[k])
sigma2[k+1] <- sigma2[k] * (1 - refl[k]^2)
}
}
list(phi = phi, refl = refl, sigma2 = sigma2)
}
innovation_algorithm <- function(gamma, x = NULL, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
theta <- matrix(0, nrow = m, ncol = m)
v <- numeric(m+1)
v[1] <- gamma[1]
theta[1,1] <- gamma[2] / v[1]
v[2] <- v[1] * (1 - theta[1,1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(theta[k-1,1:(k-1)] * rev(gamma[2:k]))
theta[k,k] <- num / v[k]
for (j in 1:(k-1)) {
theta[k,j] <- theta[k-1,j] - theta[k,k] * theta[k-1,k-j+1]
}
v[k+1] <- v[k] * (1 - theta[k,k]^2)
}
}
out <- list(theta = theta, v = v)
if (!is.null(x)) {
n <- length(x)
nu <- numeric(n)
nu[1] <- x[1]
if (n >= 2) {
for (t in 2:n) {
k <- t-1
if (k <= m) preds <- theta[k,1:k] else preds <- theta[m,1:m]
nu[t] <- x[t] - sum(preds * rev(nu[(t-k):(t-1)]))
}
}
out$nu <- nu
}
out
}
sample_acov <- function(x, m = length(x)-1) {
x <- as.numeric(x)
n <- length(x)
xbar <- mean(x)
gamma <- numeric(m+1)
for (h in 0:m) {
gamma[h+1] <- sum((x[1:(n-h)] - xbar) * (x[(1+h):n] - xbar)) / n
}
gamma
}
set.seed(12345)
n <- 50
ar2 <- as.numeric(arima.sim(model = list(ar = c(0.5, -0.5)), n = n))
innov_ma2 <- rnorm(n)
ma2 <- as.numeric(arima.sim(model = list(ma = c(0.5, 0.5)), n = n, innov = innov_ma2))
acf_ar2 <- acf(ar2, plot = FALSE)
acf_ma2 <- acf(ma2, plot = FALSE)
gamma_ar2 <- sample_acov(ar2, m = 49)
dl_ar2 <- durbin_levinson(gamma_ar2, m = 49)
phi50 <- dl_ar2$phi[49,1:49]
DL_pred_ar2 <- sum(phi50 * rev(ar2))
phi1 <- 0.5
phi2 <- -0.5
theoretical_ar2 <- phi1 * ar2[50] + phi2 * ar2[49]
gamma_ma2 <- sample_acov(ma2, m = 49)
inno_ma2 <- innovation_algorithm(gamma_ma2, x = ma2, m = 49)
theta50 <- inno_ma2$theta[49,1:49]
nu <- inno_ma2$nu
inno_pred_ma2 <- sum(theta50 * rev(nu))
theta1 <- 0.5
theta2 <- 0.5
theoretical_ma2 <- theta1 * innov_ma2[50] + theta2 * innov_ma2[49]
theoretical_ma2
durbin_levinson <- function(gamma, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
phi <- matrix(NA, nrow = m, ncol = m)
refl <- numeric(m)
sigma2 <- numeric(m+1)
sigma2[1] <- gamma[1]
refl[1] <- gamma[2] / gamma[1]
phi[1,1] <- refl[1]
sigma2[2] <- sigma2[1] * (1 - refl[1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(phi[k-1,1:(k-1)] * rev(gamma[2:k]))
refl[k] <- num / sigma2[k]
phi[k,1:k] <- c(phi[k-1,1:(k-1)] - refl[k] * rev(phi[k-1,1:(k-1)]), refl[k])
sigma2[k+1] <- sigma2[k] * (1 - refl[k]^2)
}
}
list(phi = phi, refl = refl, sigma2 = sigma2)
}
innovation_algorithm <- function(gamma, x = NULL, m = NULL) {
if (is.null(m)) m <- length(gamma)-1
gamma <- as.numeric(gamma)
theta <- matrix(0, nrow = m, ncol = m)
v <- numeric(m+1)
v[1] <- gamma[1]
theta[1,1] <- gamma[2] / v[1]
v[2] <- v[1] * (1 - theta[1,1]^2)
if (m >= 2) {
for (k in 2:m) {
num <- gamma[k+1] - sum(theta[k-1,1:(k-1)] * rev(gamma[2:k]))
theta[k,k] <- num / v[k]
for (j in 1:(k-1)) {
theta[k,j] <- theta[k-1,j] - theta[k,k] * theta[k-1,k-j+1]
}
v[k+1] <- v[k] * (1 - theta[k,k]^2)
}
}
out <- list(theta = theta, v = v)
if (!is.null(x)) {
n <- length(x)
nu <- numeric(n)
nu[1] <- x[1]
if (n >= 2) {
for (t in 2:n) {
k <- t-1
if (k <= m) preds <- theta[k,1:k] else preds <- theta[m,1:m]
nu[t] <- x[t] - sum(preds * rev(nu[(t-k):(t-1)]))
}
}
out$nu <- nu
}
out
}
sample_acov <- function(x, m = length(x)-1) {
x <- as.numeric(x)
n <- length(x)
xbar <- mean(x)
gamma <- numeric(m+1)
for (h in 0:m) {
gamma[h+1] <- sum((x[1:(n-h)] - xbar) * (x[(1+h):n] - xbar)) / n
}
gamma
}
set.seed(12345)
n <- 50
ar2 <- as.numeric(arima.sim(model = list(ar = c(0.5, -0.5)), n = n))
innov_ma2 <- rnorm(n)
ma2 <- as.numeric(arima.sim(model = list(ma = c(0.5, 0.5)), n = n, innov = innov_ma2))
acf_ar2 <- acf(ar2, plot = FALSE)
acf_ma2 <- acf(ma2, plot = FALSE)
gamma_ar2 <- sample_acov(ar2, m = 49)
dl_ar2 <- durbin_levinson(gamma_ar2, m = 49)
phi50 <- dl_ar2$phi[49,1:49]
DL_pred_ar2 <- sum(phi50 * rev(ar2))
phi1 <- 0.5
phi2 <- -0.5
theoretical_ar2 <- phi1 * ar2[50] + phi2 * ar2[49]
gamma_ma2 <- sample_acov(ma2, m = 49)
inno_ma2 <- innovation_algorithm(gamma_ma2, x = ma2, m = 49)
theta50 <- inno_ma2$theta[49,1:49]
nu <- inno_ma2$nu
inno_pred_ma2 <- sum(theta50 * rev(nu))
theta1 <- 0.5
theta2 <- 0.5
theoretical_ma2 <- theta1 * innov_ma2[50] + theta2 * innov_ma2[49]
inno_pred_ma2
theoretical_ma2
acf(diff_gtemp, main="ACF of Differenced Data")
diff_gtemp <- diff(gtemp.ocean, lag=1)
library(astsa)
install.packages("astsa")
library(astsa)
plot.ts(gtemp.ocean, main="Global Ocean Temperature", ylab="Temperature Anomaly")
library(astsa)
plot.ts(gtemp.ocean, main="Global Ocean Temperature", ylab="Temperature Anomaly")
library(astsa)
plot.ts(gtemp.ocean, main="Global Ocean Temperature", ylab="Temperature Anomaly")
library(astsa)
plot.ts(gtemp_ocean, main="Global Ocean Temperature", ylab="Temperature Anomaly")
diff_gtemp <- diff(gtemp_ocean, lag=1)
plot.ts(diff_gtemp, main="Differenced Global Ocean Temperature", ylab="Differenced Temp")
acf(diff_gtemp, main="ACF of Differenced Data")
pacf(diff_gtemp, main="PACF of Differenced Data")
sarima(gtemp.ocean, p=3, d=1, q=2)
sarima(gtemp_ocean, p=3, d=1, q=2)
sarima(gtemp_ocean, p=3, d=1, q=2)
sarima.for(gtemp_ocean, n.ahead=20, p=3, d=1, q=2)
library(astsa)
plot.ts(AirPassengers)
log.data <- log(AirPassengers)
dlog.data <- diff(log.data, 1)
ddlog.data <- diff(dlog.data, 12)
plot.data <- cbind(AirPassengers, log.data, dlog.data, ddlog.data)
plot.ts(plot.data)
acf2(ddlog.data)
sarima(ddlog.data, 1, 0, 1)
sarima(log.data, 0, 1, 1, 0, 1, 1, 12)
sarima(log.data, 0, 1, 1, 1, 1, 0, 12)
sarima.for(log.data, n.ahead = 24, 0, 1, 1, 1, 1, 0, 12)
plot.ts(AirPassengers)
log.data <- log(AirPassengers)
dlog.data <- diff(log.data, 1)
ddlog.data <- diff(dlog.data, 12)
plot.data <- cbind(AirPassengers, log.data, dlog.data, ddlog.data)
plot.ts(plot.data)
acf2(ddlog.data)
sarima(ddlog.data, 1, 0, 1)
sarima(log.data, 0, 1, 1, 0, 1, 1, 12)
sarima(log.data, 0, 1, 1, 1, 1, 0, 12)
sarima.for(log.data, n.ahead = 24, 0, 1, 1, 1, 1, 0, 12)
train <- read.csv("DailyDelhiClimateTrain")
test <- read.csv("DailyDelhiClimateTest")
setwd("~/Climate Time Series Project")
train <- read.csv("DailyDelhiClimateTrain")
train <- read.csv("DailyDelhiClimateTrain")
setwd("~/Climate Time Series Project")
train <- read.csv("DailyDelhiClimateTrain")
train <- read.csv("DailyDelhiClimateTrain")
train <- read.csv("DailyDelhiClimateTrain")
train <- read.csv("DailyDelhiClimateTrain")
setwd("~/Climate Time Series Project")
train <- read.csv("DailyDelhiClimateTrain")
getwd()
DailyDelhiClimateTrain <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTrain.csv")
View(DailyDelhiClimateTrain)
train <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTrain.csv")
test <- read.csv("DailyDelhiClimateTest")
DailyDelhiClimateTest <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTest.csv")
View(DailyDelhiClimateTest)
train <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTrain.csv")
test <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTest.csv")
library(tidyverse)
#| message: false
#| warning: false
library(tidyverse)
train <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTrain.csv")
test <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTest.csv")
plot.ts(train)
library(zoo)
z_train <- zoo(train$meantemp, orderby=train$date)
z_train <- zoo(train$meantemp, order.by=train$date)
plot.ts(train)
plot.ts(z_train)
plot.ts(log(z_train))
z_train <- zoo(train$meantemp, order.by=train$date)
plot.ts(z_train)
plot.ts(log(z_train))
adf.test(z_train)
library(adf)
library(kpss)
install.packages("adf")
install.packages("kpss")
#| message: false
#| warning: false
library(tidyverse)
library(zoo)
library(adf)
install.packages("atsa")
R --version
--version
Rversion()
R --version
install.packages('aTSA')
install.packages("Rtools")
install.packages('aTSA')
library(aTSA)
install.packages('tseries')
library(tseries)
adf.test(z_train)
kpss.test(z_train)
adf.test(z_train)
kpss.test(z_train)
diff(z_train)
#| message: false
#| warning: false
library(tidyverse)
library(zoo)
library(aTSA)
library(tseries)
## import data
train <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTrain.csv")
test <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTest.csv")
## use zoo to convert data into time series
z_train <- zoo(train$meantemp, order.by=train$date)
plot.ts(z_train)
adf.test(z_train)
kpss.test(z_train)
z_train<-diff(z_train)
adf.test(z_train)
adf.test(z_train)
kpss.test(z_train)
z_train<-diff(z_train)
adf.test(z_train)
#| message: false
#| warning: false
library(tidyverse)
library(zoo)
library(aTSA)
library(tseries)
## import data
train <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTrain.csv")
test <- read.csv("~/Climate Time Series Project/DailyDelhiClimateTest.csv")
## use zoo to convert data into time series
z_train <- zoo(train$meantemp, order.by=train$date)
plot.ts(z_train)
adf.test(z_train)
kpss.test(z_train)
z_train<-diff(z_train)
adf.test(z_train)
plot.ts(z_train)
